const e={fcp:{podr:400,median:3e3,weight:25},lcp:{podr:2250,median:4e3,weight:40},fid:{podr:40,median:300,weight:20},cls:{podr:.055,median:.25,weight:15}};function t(t,n={}){if(!t||0===Object.keys(t).length)throw new Error("Provide values");return function(e){if((e=e.filter(e=>e.weight>0)).some(e=>null===e.score))return null;const t=e.reduce((e,t)=>{const r=t.score,n=t.weight;return{weight:e.weight+n,sum:e.sum+r*n}},{weight:0,sum:0});return r(t.sum/t.weight||0)}(Object.keys(t).map(o=>{const i=o,c=t[i],s=n[i]||e[i];if(!s)throw new Error("Invalid metric: "+i);if("number"!=typeof c)throw new Error(`Invalid value: ${i}=${c}`);return{score:function(e,t,n){let o=function(e,t){const r=Math.log(e),n=Math.log(t/e),o=Math.sqrt(1-3*n-Math.sqrt((n-3)*(n-3)-8))/2;return{computeComplementaryPercentile:e=>(1-function(e){const t=Math.sign(e),r=1/(1+.3275911*(e=Math.abs(e)));return t*(1-r*(.254829592+r*(r*(1.421413741+r*(1.061405429*r-1.453152027))-.284496736))*Math.exp(-e*e))}((Math.log(e)-r)/(Math.SQRT2*o)))/2}}(n,t).computeComplementaryPercentile(e);return o=Math.min(1,o),o=Math.max(0,o),r(o)}(c,s.podr,s.median),weight:s.weight}}))}function r(e){return Math.round(100*e)/100}const n=new Map;chrome.runtime.onMessage.addListener((e,r)=>{const o=r.tab?r.tab.id:null;if(!o)return;const i={...(n.get(o)||{score:1,values:{}}).values,...e},c={score:t(i),values:i};n.set(o,c),function(e,t){if(!t.values.lcp)return;const r=t.score>=.9?"#42B29A":t.score>=.5?"#FFC15E":"$EF6853";chrome.browserAction.setTitle({title:JSON.stringify(t),tabId:e}),chrome.browserAction.setBadgeText({text:Math.round(100*t.score).toString(),tabId:e}),chrome.browserAction.setBadgeBackgroundColor({color:r,tabId:e})}(o,c)});
